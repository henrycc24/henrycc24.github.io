<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <meta content="#ffffff" name="theme-color" />
  <meta content="#da532c" name="msapplication-TileColor" />

  
  <link href='&#x2F;icons&#x2F;site.webmanifest' rel="manifest" />
  
  
  <link color="#5bbad5" href='&#x2F;icons&#x2F;safari-pinned-tab.svg' rel="mask-icon" />
  
  
  <link href='&#x2F;icons&#x2F;favicon-16x16.png' rel="icon" sizes="16x16" type="image/png" />
  
  
  <link href='&#x2F;icons&#x2F;favicon-32x32.png' rel="icon" sizes="32x32" type="image/png" />
  
  
  <link href='&#x2F;icons&#x2F;apple-touch-icon.png' rel="apple-touch-icon" sizes="180x180" />
  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/themes/folio/galleria.folio.min.css" integrity="sha384-+rY0QD+LRnTOquDMzGa9lXU6jIwdiQuwCJQ2cdcW0qeP/0UbjQCZlXnRsUMA+9pH" crossorigin="anonymous">
  

  
  <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css" integrity="sha384-oGm59HWAkwO32h2w8u0B98wKBZJwd6MbWtAJwQKCTffZjOXHXrnyv9Syjovgc+UV" crossorigin="anonymous">
  

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.1/css/academicons.min.css" integrity="sha384-FIue+PI4SsI9XfHCz8dBLg33b0c1fMJgNU3X//L26FYbGnlSEfWmNT7zgWc2N9b6" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link href="https://henrycc24.github.io/deep-thought.css" rel="stylesheet" />
  
  

  <title>
    
 | Lab 2

  </title>

  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=&lt;your_gtag&gt;"></script>
  <script type="text/javascript">
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());
    gtag("config", "&lt;your_gtag&gt;");
  </script>
  
  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx" crossorigin="anonymous"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mathtex-script-type.min.js" integrity="sha384-jiBVvJ8NGGj5n7kJaiWwWp9AjC+Yh8rhZY3GtAX8yU28azcLgoRo4oukO87g7zDT" crossorigin="anonymous"></script>
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
  
  
</head>

<body class="has-background-white">
  <nav aria-label="section navigation" class="navbar is-light" role="navigation">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item is-size-5 has-text-weight-bold" href="https:&#x2F;&#x2F;henrycc24.github.io"></a>
        <a aria-expanded="false" aria-label="menu" class="navbar-burger burger" data-target="navMenu" role="button">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div class="navbar-menu" id="navMenu">
        <div class="navbar-end has-text-centered">
          
          
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;henrycc24.github.io&#x2F;">
            Home
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;henrycc24.github.io&#x2F;Labs">
            Labs
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;henrycc24.github.io&#x2F;about">
            about
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;henrycc24.github.io&#x2F;reference">
            references
          </a>
          
          
          
          <a class="navbar-item" id="nav-search" title="Search" data-target="#search-modal">
            <span class="icon">
              <i class="fas fa-search"></i>
            </span>
          </a>
          <a class="navbar-item" id="dark-mode" title="Switch to dark theme">
            <span class="icon">
              <i class="fas fa-adjust"></i>
            </span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  
  

  
<section class="section">
  <div class="container">
    <div class="columns">
      <div class="column is-8 is-offset-2">
        <article class="box">
          <h1 class="title">
            Lab 2
          </h1>
          <p class="subtitle">IMU</p>
          <div class="columns is-multiline is-gapless">
            <div class="column is-8">
              
<span class="icon-text has-text-grey">
  <span class="icon">
    <i class="fas fa-user"></i>
  </span>
  <span>DeepThought published on</span>
  <span class="icon">
    <i class="far fa-calendar-alt"></i>
  </span>
  <span><time datetime="2025-01-31">January 31, 2025</time></span>
</span>

            </div>
            <div class="column is-4 has-text-right-desktop">
              
<span class="icon-text has-text-grey">
  <span class="icon">
    <i class="far fa-clock"></i>
  </span>
  <span>8 min,</span>
  <span class="icon">
    <i class="fas fa-pencil-alt"></i>
  </span>
  <span>1598 words</span>
</span>

            </div>
            <div class="column">
              
            </div>
            <div class="column has-text-right-desktop">
              
            </div>
          </div>
          <div class="content mt-2">
            <blockquote>
<p>Lab2: Here we are working with the IMU so we can add it to our robot. Experimenting gathering data with the accelerometer and gyroscope, plus making a stunt with our RC robot.</p>
</blockquote>
<h1 id="tasks">Tasks</h1>
<h1 id="lab-2">Lab 2</h1>
<p>The first lab we look into the examples given in the Ardruino library to test out our Artemis capabilities.</p>
<h2 id="1-setting-up-the-imu"><strong>1. Setting Up the IMU</strong></h2>
<p>Before we start up the lab we had to connect our IMU to the Artemis board using QWIIC connectors, and connecting it at the I2C port.
Then we had to install the SparkFun Ardruino library in order to use the senesors provided. However, example_basics didn't work for me so instead I used the example code provided from lecture 4. the AD0_VAL I left it as 1, for when I changed it to 0 my program continously crashed. AD0_VAL is what allows us to connect 2 IMUs at the same time to the board.
<img src="https://henrycc24.github.io/Labs/lab2/Connection.png" alt="alt text" /></p>
<p>To test out the gyroscope and accelerometer I used the serial plotter and ran the lecture 4 code as shown below.</p>
<p><img src="https://henrycc24.github.io/Labs/lab2/GyroLec4.png" alt="alt text" />
<img src="https://henrycc24.github.io/Labs/lab2/AccLec4.png" alt="alt text" /></p>
<p>In the accelerometer data there is a lot of noise when you lay it still, let alone move it around which gives inaccurate measurements. While the Gyro doesn't have as much noise since it dependent on the change of angle.</p>
<p>To make sure our IMU is working, after it is setup I implemented it such that it will blink an LED three times as shown below.</p>
<p><a href="https://youtu.be/FeWk2GNqrH0"><img src="https://markdown-videos-api.jorgenkh.no/youtube/FeWk2GNqrH0" alt="" /></a></p>
<h2 id="2-accelerometer"><strong>2. Accelerometer</strong></h2>
<h3 id="1-pitch-and-roll">1. Pitch and Roll</h3>
<pre data-lang="c" style="background-color:#2b303b;color:#c0c5ce;" class="language-c "><code class="language-c" data-lang="c"><span>    </span><span style="color:#b48ead;">float</span><span> Acc_pitch;
</span><span>    </span><span style="color:#b48ead;">float</span><span> Acc_roll; 
</span><span>    Acc_pitch = </span><span style="color:#96b5b4;">atan2</span><span>(myICM.</span><span style="color:#bf616a;">accX</span><span>(),myICM.</span><span style="color:#bf616a;">accZ</span><span>())*</span><span style="color:#d08770;">180</span><span>/M_PI; 
</span><span>    Acc_roll  = </span><span style="color:#96b5b4;">atan2</span><span>(myICM.</span><span style="color:#bf616a;">accY</span><span>(),myICM.</span><span style="color:#bf616a;">accZ</span><span>())*</span><span style="color:#d08770;">180</span><span>/M_PI; 
</span></code></pre>
<p>To calculate pitch and roll I used these equations sourced from the lecture. Yaw can't be measured since it's on the same axis of gravity (z-axis), which is why we can only get pirch and roll from the accelerometer. The Accelerometer is fairly accurate when trying to position it and right angles such as {-90, 0, 90} as shown below.</p>
<p><a href="https://youtu.be/7dr8tfD84Kc"><img src="https://markdown-videos-api.jorgenkh.no/youtube/7dr8tfD84Kc" alt="" /></a></p>
<p>The main issue with it is that the values flucuate a lot in small increments (noise), even when it held as still as possible or left to sit on a table.</p>
<h3 id="2-accelerometer-noise-and-fft">2. Accelerometer Noise and FFT</h3>
<pre data-lang="c" style="background-color:#2b303b;color:#c0c5ce;" class="language-c "><code class="language-c" data-lang="c"><span>{
</span><span>    </span><span style="color:#b48ead;">case</span><span> Get_Pitch_Roll: {
</span><span>        </span><span style="color:#b48ead;">int</span><span> i = </span><span style="color:#d08770;">0</span><span>;
</span><span>        </span><span style="color:#b48ead;">for </span><span>(i; i &lt; data_array_size; i++){
</span><span>            </span><span style="color:#b48ead;">if</span><span>(myICM.</span><span style="color:#bf616a;">dataReady</span><span>()){
</span><span>                myICM.</span><span style="color:#bf616a;">getAGMT</span><span>();
</span><span>                RoPi_array[i].</span><span style="color:#bf616a;">time </span><span>= (</span><span style="color:#b48ead;">int</span><span>) </span><span style="color:#bf616a;">millis</span><span>();
</span><span>                RoPi_array[i].</span><span style="color:#bf616a;">pitch </span><span>= (</span><span style="color:#b48ead;">float</span><span>) (</span><span style="color:#96b5b4;">atan2</span><span>(myICM.</span><span style="color:#bf616a;">accX</span><span>(),myICM.</span><span style="color:#bf616a;">accZ</span><span>())*</span><span style="color:#d08770;">180</span><span>/M_PI);
</span><span>                 RoPi_array[i].</span><span style="color:#bf616a;">roll </span><span>= (</span><span style="color:#b48ead;">float</span><span>) (</span><span style="color:#96b5b4;">atan2</span><span>(myICM.</span><span style="color:#bf616a;">accY</span><span>(),myICM.</span><span style="color:#bf616a;">accZ</span><span>())*</span><span style="color:#d08770;">180</span><span>/M_PI);
</span><span>                </span><span style="color:#bf616a;">delay</span><span>(</span><span style="color:#d08770;">5</span><span>);
</span><span>              }
</span><span>            }
</span><span>          Serial.</span><span style="color:#bf616a;">print</span><span>(i);
</span><span>          Serial.</span><span style="color:#bf616a;">println</span><span>(&quot;</span><span style="color:#a3be8c;"> pitches/rolls saved</span><span>&quot;);
</span><span>          </span><span style="color:#b48ead;">break</span><span>; 
</span><span>        }
</span><span>}
</span></code></pre>
<p>Similar to lab1, to gather accelerometer data we just created a loop that itereated through our data_array_size that in this is also 1000 samples. Using the same equations as before to calculate the roll and pitch. Here are the graphs of the all the data gathered for roll and pitch.</p>
<p><img src="https://henrycc24.github.io/Labs/lab2/Pitch_acc.png" alt="alt text" /> <img src="https://henrycc24.github.io/Labs/lab2/Roll_acc.png" alt="alt text" />
<img src="https://henrycc24.github.io/Labs/lab2/FFT_pitch.png" alt="alt text" /> <img src="https://henrycc24.github.io/Labs/lab2/FFT_roll.png" alt="alt text" /></p>
<p>This is the python used to graph it with numpy and plt packages. As well as that using the fft packages with numpy.</p>
<p><img src="https://henrycc24.github.io/Labs/lab2/RoPi_fft_graph.png" alt="alt text" /> <img src="https://henrycc24.github.io/Labs/lab2/RoPi_graph.png" alt="alt text" /></p>
<p>As you can see from the FFT there seems to be a very large peak at the beginning frequencies of the array. It seems to happen at abour &lt;2 Hz, which is what I will use at the cuttoff frequency. It being a low frequency is because the IMU already has a low pass fitler for the accelrometer and gryoscope. However, knowing what our cutoff frequency is then we can calcuate our alpha calue that we can use for a low pass filter to filter out even more noise. The cutoff frequency is important to select to block off any random or high noise, to make are data more stable. To calcualte the alpha we get RC = 1/(2 * pi * 2), then with that RC value we get alpha = dt/(dt+RC). Where dt is the average of change of time for the whole array of calcualted values for roll/pitch. We get an alpha value of .08, which we will use for our low pass filter.</p>
<h3 id="3-low-pass-filter"><strong>3. Low-Pass Filter</strong></h3>
<pre data-lang="c" style="background-color:#2b303b;color:#c0c5ce;" class="language-c "><code class="language-c" data-lang="c"><span>{
</span><span>    </span><span style="color:#b48ead;">case</span><span> LPF_Roll_Pitch: {
</span><span>        </span><span style="color:#b48ead;">const float</span><span> alpha = </span><span style="color:#d08770;">0.08</span><span>;
</span><span>        Roll_lpf[</span><span style="color:#d08770;">0</span><span>] = RoPi_array[</span><span style="color:#d08770;">1</span><span>].</span><span style="color:#bf616a;">roll</span><span>;
</span><span>        Pitch_lpf[</span><span style="color:#d08770;">0</span><span>] = RoPi_array[</span><span style="color:#d08770;">1</span><span>].</span><span style="color:#bf616a;">pitch</span><span>;
</span><span>        </span><span style="color:#b48ead;">for </span><span>(</span><span style="color:#b48ead;">int</span><span> i = </span><span style="color:#d08770;">1</span><span>; i &lt; (data_array_size); i++){
</span><span>            Pitch_lpf[i] = alpha * RoPi_array[i].</span><span style="color:#bf616a;">pitch </span><span>+ (</span><span style="color:#d08770;">1</span><span>-alpha) * Pitch_lpf[i-</span><span style="color:#d08770;">1</span><span>];
</span><span>            Pitch_lpf[i-</span><span style="color:#d08770;">1</span><span>] = Pitch_lpf[i];
</span><span>            Roll_lpf[i] = alpha * RoPi_array[i].</span><span style="color:#bf616a;">roll </span><span>+ (</span><span style="color:#d08770;">1</span><span>-alpha) * Roll_lpf[i-</span><span style="color:#d08770;">1</span><span>];
</span><span>            Roll_lpf[i-</span><span style="color:#d08770;">1</span><span>] = Roll_lpf[i];
</span><span>        }
</span><span>        Serial.</span><span style="color:#bf616a;">println</span><span>(&quot;</span><span style="color:#a3be8c;">lpf pitches/rolls saved</span><span>&quot;);
</span><span>        </span><span style="color:#b48ead;">break</span><span>; 
</span><span>    }
</span><span>}
</span></code></pre>
<p>In order to create a low pass filter we have to iterate thorugh our orignal roll and pitch data, and then adjust the values with alpha as shown above. After gathering the low-pass data, the graphs are shown below.</p>
<p><img src="https://henrycc24.github.io/Labs/lab2/roll_lpf.png" alt="alt text" /> <img src="https://henrycc24.github.io/Labs/lab2/pitch_lpf.png" alt="alt text" /></p>
<p>As can be seen, the low-pass filter reduced a lot of noise! Meaning that the our data is even more accurate then it was earlier with the alpha value of .08, which will even come more into play when we do sensor fusion.</p>
<h2 id="3-gyroscope"><strong>3. Gyroscope</strong></h2>
<h3 id="1-pitch-roll-and-yaw"><strong>1. Pitch, Roll and Yaw</strong></h3>
<pre data-lang="c" style="background-color:#2b303b;color:#c0c5ce;" class="language-c "><code class="language-c" data-lang="c"><span>{
</span><span>    </span><span style="color:#b48ead;">case</span><span> GYRO_DATA: {
</span><span>        </span><span style="color:#b48ead;">int</span><span> i = </span><span style="color:#d08770;">1</span><span>;
</span><span>        </span><span style="color:#b48ead;">float</span><span> dt;
</span><span>        </span><span style="color:#b48ead;">unsigned long</span><span> last_time = </span><span style="color:#bf616a;">millis</span><span>(); 
</span><span>        time_array[</span><span style="color:#d08770;">0</span><span>] = last_time;
</span><span>        </span><span style="color:#bf616a;">delay</span><span>(</span><span style="color:#d08770;">100</span><span>);
</span><span>        </span><span style="color:#b48ead;">for </span><span>(i; i &lt; data_array_size; i++){
</span><span>            </span><span style="color:#b48ead;">if</span><span>(myICM.</span><span style="color:#bf616a;">dataReady</span><span>()){
</span><span>                myICM.</span><span style="color:#bf616a;">getAGMT</span><span>();
</span><span>                dt = ((</span><span style="color:#bf616a;">millis</span><span>() - last_time)/</span><span style="color:#d08770;">1000.0</span><span>);
</span><span>                last_time = </span><span style="color:#bf616a;">millis</span><span>();
</span><span>                time_array[i]= (</span><span style="color:#b48ead;">int</span><span>) </span><span style="color:#bf616a;">millis</span><span>();
</span><span>                Gyro_roll[i] = Gyro_roll[i-</span><span style="color:#d08770;">1</span><span>] + (myICM.</span><span style="color:#bf616a;">gyrX</span><span>()*dt);
</span><span>                Gyro_pitch[i] = Gyro_pitch[i-</span><span style="color:#d08770;">1</span><span>] + (myICM.</span><span style="color:#bf616a;">gyrY</span><span>()*dt);
</span><span>                Gyro_yaw[i] = Gyro_yaw[i-</span><span style="color:#d08770;">1</span><span>] + (myICM.</span><span style="color:#bf616a;">gyrZ</span><span>()*dt);
</span><span>                </span><span style="color:#bf616a;">delay</span><span>(</span><span style="color:#d08770;">1</span><span>);
</span><span>              }
</span><span>        }
</span><span>        Serial.</span><span style="color:#bf616a;">println</span><span>(&quot;</span><span style="color:#a3be8c;">sent the gyros</span><span>&quot;);
</span><span>        </span><span style="color:#b48ead;">break</span><span>;
</span><span>    }
</span><span>}
</span></code></pre>
<p>The pitch, roll, and yaw from the gyroscope unlike the accelerometer measure the change in angle/time. To calculate the gyroscope we use a whole different set of equations, where we must include the change in time (dt) which is shown above in my code. Furthermore, the angle of the gryoscrope is dependent on the previous result which showcases a lot of drift. When it laying on a table, there is no change in angle, but since it adding onto itself the roll and pitch as seen by the graphs continously increase over time. On the other hand the accelerometer doesn't have drift, but has a lot of noise which the gyroscope doesn't have.</p>
<p><img src="https://henrycc24.github.io/Labs/lab2/RoPiYa.png" alt="alt text" /> <img src="https://henrycc24.github.io/Labs/lab2/Sample_rate.png" alt="alt text" /></p>
<p>Here are two images with different sample frequencies. The one of the left is with a smaller sample frequency, while the right has a larger implemented with delays. The larger the sample rate the more drift it will have, which makes sense since dt will be larger when calculating for the roll and pitch. Meaning that you want to have the smallest possible sample rate when calculating gyroscope.</p>
<h3 id="1-complementary-filter"><strong>1. Complementary Filter</strong></h3>
<p>With the gyroscope and accelerometer we can perform sensor fusion in which we will create a complementary filter. Using the advantages of both sensors, we end up with almost no noise or drift for our calculated roll and pitch.</p>
<pre data-lang="c" style="background-color:#2b303b;color:#c0c5ce;" class="language-c "><code class="language-c" data-lang="c"><span>{
</span><span>        </span><span style="color:#b48ead;">case</span><span> COMP_FILTER: {
</span><span>          </span><span style="color:#b48ead;">int</span><span> i = </span><span style="color:#d08770;">1</span><span>;
</span><span>            </span><span style="color:#b48ead;">for </span><span>(i; i &lt; data_array_size; i++){
</span><span>                </span><span style="color:#b48ead;">if</span><span>(myICM.</span><span style="color:#bf616a;">dataReady</span><span>()){
</span><span>                myICM.</span><span style="color:#bf616a;">getAGMT</span><span>();
</span><span>                time_array[i] = </span><span style="color:#bf616a;">millis</span><span>();
</span><span>                Acc_pitch = alpha_lpf * (</span><span style="color:#96b5b4;">atan2</span><span>(myICM.</span><span style="color:#bf616a;">accX</span><span>(),myICM.</span><span style="color:#bf616a;">accZ</span><span>())*</span><span style="color:#d08770;">180</span><span>/M_PI) + (</span><span style="color:#d08770;">1</span><span>-alpha_lpf) * Acc_pitch;
</span><span>                Acc_roll = alpha_lpf * (</span><span style="color:#96b5b4;">atan2</span><span>(myICM.</span><span style="color:#bf616a;">accY</span><span>(), myICM.</span><span style="color:#bf616a;">accZ</span><span>())*</span><span style="color:#d08770;">180</span><span>/M_PI) + (</span><span style="color:#d08770;">1</span><span>-alpha_lpf) * Acc_roll;
</span><span>                dt = (time_array[i] - time_array[i-</span><span style="color:#d08770;">1</span><span>])/</span><span style="color:#d08770;">1000.0</span><span>;
</span><span>
</span><span>                Comp_pitch[i] = (Comp_pitch[i-</span><span style="color:#d08770;">1</span><span>] + myICM.</span><span style="color:#bf616a;">gyrY</span><span>()*dt)*(</span><span style="color:#d08770;">1</span><span>-alpha_comp) + (Acc_pitch)* alpha_comp;
</span><span>                Comp_roll[i] = (Comp_roll[i-</span><span style="color:#d08770;">1</span><span>] + myICM.</span><span style="color:#bf616a;">gyrX</span><span>()*dt)*(</span><span style="color:#d08770;">1</span><span>-alpha_comp) + (Acc_roll)* alpha_comp;
</span><span>              }
</span><span>          }
</span><span>            </span><span style="color:#b48ead;">break</span><span>;
</span><span>        }
</span><span>}
</span></code></pre>
<p>Here is most of the code used for create the filter, and key to note is that we also use an alpha value, but this alpha is different from our low pass filter one. In this case we need to adjust our alpha to when we start seeing the low-pass filter peak, which is at around 10 Hz as calculated using the FFT graph. Seeing that around that hertz is where it stabilizes, I was able to calculate with the same formula as before the alpha to be .3 which is what I used and it worked really well as shown below.</p>
<p><img src="https://henrycc24.github.io/Labs/lab2/Comp_roll.png" alt="alt text" /> <img src="https://henrycc24.github.io/Labs/lab2/Comp_zoom.png" alt="alt text" />
<img src="https://henrycc24.github.io/Labs/lab2/Gyro_comp.png" alt="alt text" /> <img src="https://henrycc24.github.io/Labs/lab2/LPF_comp.png" alt="alt text" /></p>
<p>These graphs are displaying data of me while I was moving and rotating the imu around which is why the normall roll and pitch go hectic. However, as you can see with the zoom in graph (top right), the complementary filter did its job. It was the smoothest graph out of all three options, even though the low pass filter was very similar. However, we can also see that there is a lot of noise if you don't use a lpf. It makes sense though why the complementary filter didn't get too affected cause we push a low-pass filter on a low-pass filter, that is passed on a built in one on a chip. There only room for so much optimization.</p>
<h2 id="2-sample-data"><strong>2. Sample Data</strong></h2>
<p>Now its time for optimzation within our code in order to get the fastest sample rate and message sent across. To do this I removed a lot of useless code and print statements that took up time. Furthermore, I removed a lot of the delays and made it such that all the values of accelerometer roll and pitch, gyroscope roll, pitch and yaw, and complementary roll and pitch can be calculated in one command. Meaning that I don't have to call multiple commands since all the calcualtions including the low pass filter of the accelertometer are performed. I also ran some tests to see what would be faster, sending the data live while computing or just computing the array then sending that. To my suprise there was a significant difference between live sending, and sending the data after its collected! If you send it live to gather 1000 samples it took 30 second meaning our sample frequency was very large! This resulted in a cascading affect where of gryoscope was less accurate, which also meant the complementary too. On the otherhand when I first got the 1000 samples then sent it, it was blazing quick at only around 3 seconds to gather all the data! 10x faster then before which also meant our dt was smaller giving us vetter gyroscope data. It still however, took a long time to send but I would rather have that occur then when it's collecting data.</p>
<p>Knowing this information in order to gather 6 secons I simply just collected 2000 samples as shown below. 2000 samples collected is around 6.3 seconds, but it still took a minute to send it all. I also printed some of the pitch values of all the sensors to showcase it gathering the data.</p>
<p><img src="https://henrycc24.github.io/Labs/lab2/5_seconds.png" alt="alt text" /></p>
<p><a href="https://youtu.be/3K57tmdrMm0"><img src="https://markdown-videos-api.jorgenkh.no/youtube/3K57tmdrMm0" alt="" /></a></p>
<p>With this speed of 6.3 seconds to collect 2000 samples, that about 300 samples per second. With the memory size of the Artemis being 384KB, lets just assume you're gathering every data you can from the sensors (10 floats * 4 bytes) meaning that you can collect 9600 sets of data points. Which then at 300 samples per second will end up with it being filled with data in 32 seconds!</p>
<h2 id="car-stunt"><strong>Car Stunt</strong></h2>
<p>Now here me playing around with our RC Car!</p>
<p><a href="https://youtu.be/vM4l_CRC5J4"><img src="https://markdown-videos-api.jorgenkh.no/youtube/vM4l_CRC5J4" alt="" /></a></p>

          </div>
        </article>
      </div>
      
    </div>
  </div>
</section>


  
  <section class="modal" id="search-modal">
    <div class="modal-background"></div>
    <div class="modal-card">
      <header class="modal-card-head">
        <p class="modal-card-title">Search</p>
      </header>
      <section class="modal-card-body">
        <div class="field mb-2">
          <div class="control">
            <input class="input" id="search" placeholder="Search this website." type="search" />
          </div>
        </div>
        <div class="search-results">
          <div class="search-results__items"></div>
        </div>
      </section>
    </div>
    <button aria-label="close" class="modal-close is-large"></button>
  </section>
  


  

<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <nav class="level">
              
          <div class="level-item has-text-centered">
            <a class="button is-black is-outlined" href="https:&#x2F;&#x2F;henrycc24.github.io&#x2F;Labs&#x2F;lab3&#x2F;">
              <span class="icon mr-2">
                <i class="fas fa-arrow-circle-left"></i>
              </span>
              Lab3
            </a>
          </div>
           
          <div class="level-item has-text-centered">
            <a class="button is-black is-outlined" href="https:&#x2F;&#x2F;henrycc24.github.io&#x2F;Labs&#x2F;lab1&#x2F;">
              Lab 1<span class="icon ml-2">
                <i class="fas fa-arrow-circle-right"></i>
              </span>
            </a>
          </div>
          
        </nav>
      </div>
    </div>
  </div>
</section>



  



  
  <footer class="footer py-4">
    <div class="content has-text-centered">
      <p>
        Built with
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-code"></i>
          </span>
          <span>code</span>
        </span>
        and
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-heart"></i>
          </span>
          <span>love</span>
        </span>
      </p>
      <p>
        Powered by
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-power-off"></i>
          </span>
          <span>zola</span>
        </span>
      </p>
    </div>
  </footer>
  

  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/galleria.min.js" integrity="sha384-QSfwGT8/EU536DKdtyP2D6SLlh8zBaZ0cVkwfrwhqzIU9VCfJT00CLVP5t+HAiYg" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/themes/folio/galleria.folio.min.js" integrity="sha384-DwpKI+deZB267+hPKwiOIc5Y2GKsVL0mR6hgz7GgIu7AgAMYqJwcJKY1YBNfhWcY" crossorigin="anonymous"></script>
  
  
  <script src="https://cdn.jsdelivr.net/npm/mermaid@8.13.5/dist/mermaid.min.js" integrity="sha384-0yWn54pSGtfKCU+skfA69l25VsCw+MZt4LQov3xNRoS7YkAMrFokGgSBnAWSK4pv" crossorigin="anonymous"></script>
  
  
  <script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1.1.13/dist/chart.xkcd.min.js" integrity="sha384-xC3h1+IHXK8seA+8KfT79Z4e0GPsznjXBoMa5nd8ooWKplPyXx92NOmljWxLC/cs" crossorigin="anonymous"></script>
  
  
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js" integrity="sha384-Pulw7+h73841BQIK0LzJCydKRPChJUF9w8h8W0o3h+cLtoyNPJS847bQauLWOTwg" crossorigin="anonymous"></script>
  
  <script src="https://henrycc24.github.io/elasticlunr.min.js"></script>
  <script src="https://henrycc24.github.io/search_index.en.js"></script><script src="https://henrycc24.github.io/js/site.js"></script>

  





  
  
</body>

</html>
