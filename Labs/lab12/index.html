<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <meta content="#ffffff" name="theme-color" />
  <meta content="#da532c" name="msapplication-TileColor" />

  
  <link href='&#x2F;icons&#x2F;site.webmanifest' rel="manifest" />
  
  
  <link color="#5bbad5" href='&#x2F;icons&#x2F;safari-pinned-tab.svg' rel="mask-icon" />
  
  
  <link href='&#x2F;icons&#x2F;favicon-16x16.png' rel="icon" sizes="16x16" type="image/png" />
  
  
  <link href='&#x2F;icons&#x2F;favicon-32x32.png' rel="icon" sizes="32x32" type="image/png" />
  
  
  <link href='&#x2F;icons&#x2F;apple-touch-icon.png' rel="apple-touch-icon" sizes="180x180" />
  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/themes/folio/galleria.folio.min.css" integrity="sha384-+rY0QD+LRnTOquDMzGa9lXU6jIwdiQuwCJQ2cdcW0qeP/0UbjQCZlXnRsUMA+9pH" crossorigin="anonymous">
  

  
  <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css" integrity="sha384-oGm59HWAkwO32h2w8u0B98wKBZJwd6MbWtAJwQKCTffZjOXHXrnyv9Syjovgc+UV" crossorigin="anonymous">
  

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.1/css/academicons.min.css" integrity="sha384-FIue+PI4SsI9XfHCz8dBLg33b0c1fMJgNU3X//L26FYbGnlSEfWmNT7zgWc2N9b6" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link href="https://henrycc24.github.io/deep-thought.css" rel="stylesheet" />
  
  

  <title>
    
 | Lab 12

  </title>

  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=&lt;your_gtag&gt;"></script>
  <script type="text/javascript">
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());
    gtag("config", "&lt;your_gtag&gt;");
  </script>
  
  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx" crossorigin="anonymous"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mathtex-script-type.min.js" integrity="sha384-jiBVvJ8NGGj5n7kJaiWwWp9AjC+Yh8rhZY3GtAX8yU28azcLgoRo4oukO87g7zDT" crossorigin="anonymous"></script>
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
  
  
</head>

<body class="has-background-white">
  <nav aria-label="section navigation" class="navbar is-light" role="navigation">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item is-size-5 has-text-weight-bold" href="https:&#x2F;&#x2F;henrycc24.github.io"></a>
        <a aria-expanded="false" aria-label="menu" class="navbar-burger burger" data-target="navMenu" role="button">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div class="navbar-menu" id="navMenu">
        <div class="navbar-end has-text-centered">
          
          
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;henrycc24.github.io&#x2F;">
            Home
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;henrycc24.github.io&#x2F;Labs">
            Labs
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;henrycc24.github.io&#x2F;about">
            about
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;henrycc24.github.io&#x2F;reference">
            references
          </a>
          
          
          
          <a class="navbar-item" id="nav-search" title="Search" data-target="#search-modal">
            <span class="icon">
              <i class="fas fa-search"></i>
            </span>
          </a>
          <a class="navbar-item" id="dark-mode" title="Switch to dark theme">
            <span class="icon">
              <i class="fas fa-adjust"></i>
            </span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  
  

  
<section class="section">
  <div class="container">
    <div class="columns">
      <div class="column is-8 is-offset-2">
        <article class="box">
          <h1 class="title">
            Lab 12
          </h1>
          <p class="subtitle">Path Planning</p>
          <div class="columns is-multiline is-gapless">
            <div class="column is-8">
              
<span class="icon-text has-text-grey">
  <span class="icon">
    <i class="fas fa-user"></i>
  </span>
  <span>DeepThought published on</span>
  <span class="icon">
    <i class="far fa-calendar-alt"></i>
  </span>
  <span><time datetime="2025-05-14">May 14, 2025</time></span>
</span>

            </div>
            <div class="column is-4 has-text-right-desktop">
              
<span class="icon-text has-text-grey">
  <span class="icon">
    <i class="far fa-clock"></i>
  </span>
  <span>6 min,</span>
  <span class="icon">
    <i class="fas fa-pencil-alt"></i>
  </span>
  <span>1078 words</span>
</span>

            </div>
            <div class="column">
              
            </div>
            <div class="column has-text-right-desktop">
              
            </div>
          </div>
          <div class="content mt-2">
            <blockquote>
<p>Lab 12 : Path Planning and Execution</p>
</blockquote>
<p><img src="https://henrycc24.github.io/Labs/lab12/planning.png" alt="alt text" /></p>
<p>The final lab in which we have to naviagite throghout the waypoints in as fast and accurate manner as possible. Here the image of the bath that we had to follow through. Starting from the bottom left and naviagting in a loop and ending at the center of the map.</p>
<h1 id="lab-12">Lab 12</h1>
<h2 id="a-theory-crafting">**A. Theory crafting **</h2>
<p>Throughout this lab I worked with several of my friends and brainstormed numerous methods of accomplishing this lab. Since I had back to back finals on this my friends had an early head start in which there feedback impacted a lot in the method I chose to do this lab.</p>
<p>Localiation was obsiousvly the goal to get this lab done with, since that would prove to me the most consistent method. However, even though this method was ideal it did not pan out that way when trying to run it. The ToF sensor kept providing inaccurate measurements of data that caused the robot to believe it was a different location then it was. My biggest belief in this was the ToF sensor being off angled by a few degrees. Even though it is only a few degrees off angle that would cascade in false data being read since it would try to read further distances and max out the ToF. Which when it did max out, for example at the bottom right corner it resulted in false informaiton being provided, and confusing my lil homie robot. After an hour I called it quits and decided to implement the open loop approach which could be implemented in several ways.</p>
<p>Open Loop: Now there are 2 main ways I thought about doing this. These 2 different ways was simply the method I choose to go forward wether it was time based or wether it would be from my reading of the ToF. The premise of the open loop method is really simple go forward turn go forward turn go forward and repeat until it did the whole path. While the turning was just reliant on our PID implemenation from lab 6. Here some of the code that was used.</p>
<pre data-lang="c" style="background-color:#2b303b;color:#c0c5ce;" class="language-c "><code class="language-c" data-lang="c"><span>{
</span><span style="color:#b48ead;">case</span><span> navigate: {
</span><span>  </span><span style="color:#bf616a;">forward</span><span>(x);
</span><span>  </span><span style="color:#bf616a;">PID_Control</span><span>(angle1);
</span><span>  </span><span style="color:#bf616a;">forward</span><span>(y);
</span><span>  </span><span style="color:#bf616a;">PID_Control</span><span>(angle2);
</span><span>  </span><span style="color:#bf616a;">forward</span><span>(z);
</span><span>  </span><span style="color:#bf616a;">PID_Control</span><span>(angle3);
</span><span>  </span><span style="color:#bf616a;">forward</span><span>(q);
</span><span>  </span><span style="color:#bf616a;">PID_Control</span><span>(angle4);
</span><span>  </span><span style="color:#bf616a;">forward</span><span>(t); 
</span><span>  </span><span style="color:#bf616a;">PID_Control</span><span>(angle5);
</span><span>  </span><span style="color:#bf616a;">forward</span><span>(r); 
</span><span>  </span><span style="color:#bf616a;">PID_Control</span><span>(angle6);
</span><span>  </span><span style="color:#bf616a;">forward</span><span>(w); 
</span><span>  }
</span><span>}
</span></code></pre>
<h2 id="b-open-loop">**B. Open Loop **</h2>
<p>Using the ToF and PID in order to stop the car a certain distance would be the prefered method. This would prove to be the most consistent method since obviously you would stop at the exact distance that you want. However, in order for this to work the ToF had to be very reliable. Which whle testing at first sadly didn't prove to be the case. Furthermore this method required us to get the distances from the walls to the point. However, throughout the numerous runs it would prove to be inconsistent. One was because since tthere was continous people testing there robots on the site, the walls would alter in placements and I didn't help with my robot swerving around and crashing the walls. Resulting in it being off a few cm each iteration, wether it be the sensor reading being to slow for the robot or the envirionment changing. Calculating the distances in a fixed environment wouldn't be to awful especially since the distances from the wall to the robot will always be constant. However, there is a flaw in the fact that the sensor readings might be to slow for more small spaces In a environment changing simulation this would prove not that useful for consistent path sadly as I learned.</p>
<p>Next something that really doesn't alter the environment and our final method of doing it was just controlling the forward motion of the robot with time. This in theory will always result in consistent forawrd motion, however, in reality this did not always prove to be the case. At times 500 ms was the perfect amount, then it would overshoot then undershoot and rinse and repeat. It became more of a luck based system wether the run was gonna accomplish it or not. To implement this timing it was quite simple we just used some of the logic we used for lab 8 in flipping where we went forward for a set amount of time. Chaning a bit since this time we don't have to collect PWM or ToF sensor data.</p>
<pre data-lang="c" style="background-color:#2b303b;color:#c0c5ce;" class="language-c "><code class="language-c" data-lang="c"><span>{
</span><span style="color:#b48ead;">void </span><span style="color:#bf616a;">forward</span><span>( </span><span style="color:#b48ead;">float</span><span> t ){
</span><span>  </span><span style="color:#65737e;">// initial time 
</span><span>  </span><span style="color:#b48ead;">float</span><span> init = </span><span style="color:#bf616a;">millis</span><span>(); 
</span><span>
</span><span>  </span><span style="color:#65737e;">// we used 120 PWM for a slower velocity
</span><span>  </span><span style="color:#65737e;">// both pins are to go forward 
</span><span>  </span><span style="color:#bf616a;">analogWrite</span><span>(</span><span style="color:#d08770;">1</span><span>, </span><span style="color:#d08770;">120</span><span>);
</span><span>  </span><span style="color:#bf616a;">analogWrite</span><span>(</span><span style="color:#d08770;">16</span><span>, </span><span style="color:#d08770;">120</span><span>);
</span><span>
</span><span>  </span><span style="color:#65737e;">// while loop to meet timing requirement 
</span><span>  </span><span style="color:#b48ead;">while </span><span>(( millis - init ) &lt; t ) {};
</span><span>
</span><span>  </span><span style="color:#65737e;">// STOP THE CAR
</span><span>  </span><span style="color:#bf616a;">analogWrite</span><span>(</span><span style="color:#d08770;">1</span><span>, </span><span style="color:#d08770;">0</span><span>);
</span><span>  </span><span style="color:#bf616a;">analogWrite</span><span>(</span><span style="color:#d08770;">16</span><span>, </span><span style="color:#d08770;">0</span><span>);  
</span><span>  }
</span><span>}
</span></code></pre>
<p>Furthermore her is some of the PID orientation code that was used (same code as lab 6)</p>
<pre data-lang="c" style="background-color:#2b303b;color:#c0c5ce;" class="language-c "><code class="language-c" data-lang="c"><span>{
</span><span style="color:#b48ead;">float</span><span> error = yawAngle - targetYaw;
</span><span>integral += error * dt;
</span><span>integral = </span><span style="color:#bf616a;">constrain</span><span>(integral, -</span><span style="color:#d08770;">1000</span><span>, </span><span style="color:#d08770;">1000</span><span>);  </span><span style="color:#65737e;">// Anti-windup
</span><span style="color:#b48ead;">float</span><span> derivative = (error - previousError) / dt;
</span><span>
</span><span style="color:#b48ead;">float</span><span> pTerm = Kp * error;     </span><span style="color:#65737e;">// Proportional Term
</span><span style="color:#b48ead;">float</span><span> iTerm = Ki * integral;  </span><span style="color:#65737e;">// Integral Term
</span><span style="color:#b48ead;">float</span><span> dTerm = Kd * derivative; </span><span style="color:#65737e;">// Derivative Term
</span><span>
</span><span style="color:#b48ead;">float</span><span> output = pTerm + iTerm + dTerm;
</span><span style="color:#b48ead;">int</span><span> motorSpeed = </span><span style="color:#bf616a;">constrain</span><span>(output, -</span><span style="color:#d08770;">255</span><span>, </span><span style="color:#d08770;">255</span><span>);
</span><span>
</span><span style="color:#65737e;">// Ensure Minimum Speed
</span><span style="color:#b48ead;">if </span><span>(motorSpeed &gt; </span><span style="color:#d08770;">0 </span><span>&amp;&amp; motorSpeed &lt; </span><span style="color:#d08770;">120</span><span>) {
</span><span>    motorSpeed = </span><span style="color:#d08770;">120</span><span>;
</span><span>}
</span><span style="color:#b48ead;">else if </span><span>(motorSpeed &lt; </span><span style="color:#d08770;">0 </span><span>&amp;&amp; motorSpeed &gt; -</span><span style="color:#d08770;">120</span><span>) {
</span><span>    motorSpeed = -</span><span style="color:#d08770;">120</span><span>;
</span><span>}
</span><span>}
</span></code></pre>
<pre data-lang="c" style="background-color:#2b303b;color:#c0c5ce;" class="language-c "><code class="language-c" data-lang="c"><span>{
</span><span style="color:#b48ead;">case</span><span> PATHING: {
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(x);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(angle1);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(y);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(angle2);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(z);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(angle3);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(q);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(angle4);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(t);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(angle5);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(r);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(angle6);
</span><span>  sucess = robot_cmd.</span><span style="color:#bf616a;">get_next_value</span><span>(w);
</span><span>  }
</span><span>}
</span></code></pre>
<p>In order for us to save so much time, instead of hardcoding different values of T and angles we simply create a command in python to ouput the values tbat we wanted as time and angles. Allowing us to keep values that work and also fine tune and tweak the values that we already had.</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span>
</span><span>ble.</span><span style="color:#bf616a;">send_command</span><span>(</span><span style="color:#bf616a;">CMD</span><span>.</span><span style="color:#bf616a;">PATHING</span><span>, &quot;</span><span style="color:#a3be8c;">700 | -30 | 500 | 80 | 300 | -50 | 200 | 30 | 900 | 40</span><span>&quot; ) 
</span><span>
</span></code></pre>
<p>You would think this would be streamline to do however, it is not. It took several tries to get it to work once and it took a while for it to run. The video here is 2 minutes long, and I've seen groups doing it much faster. However, Our open loop control was very accurate at the sacrafice for that time. While it is possible to have an accurate and fast localization that is now what I did. Here is the video of the car going through the track:</p>
<p><a href="https://youtu.be/i1Tq-JVp6ws"><img src="https://markdown-videos-api.jorgenkh.no/youtube/i1Tq-JVp6ws" alt="" /></a></p>
<p>In terms of consistency, it will be able to go around the track again however, it won't always be as accurate as the run posted. As mentioned before it is a luck based systems at times it felt wether or not it was going to reach the marks. However, when it did it was very accurate it made our days. There no audio sadly in the video due to the fact a lot of crashing out was occuring throguhout this lab.</p>
<h2 id="c-farwell-and-resources"><strong>C. Farwell and Resources</strong></h2>
<p><img src="https://henrycc24.github.io/Labs/lab12/prediction_step.png" alt="alt text" /></p>
<p>Huge shoutout the TAs and Professor Helbling these labs were rigourous however taught us a lot about robot localization. Furthermore shoutout to Aidan Derocher, Jorge Corpa Chung, Jennie Redrovan, Sana Chawla, and Lulu Htutt for being great friends I met from this class and helped throughout this lab and many others. It is sad that I met them this semseter and some of them are graduating, but we shared a lot of suffering and laughter from this class and good memories because of it. Lil Homie, my robot surprisngly never had any issues in terms of wires popping off no matter how much walls he has been thrown at.</p>

          </div>
        </article>
      </div>
      
    </div>
  </div>
</section>


  
  <section class="modal" id="search-modal">
    <div class="modal-background"></div>
    <div class="modal-card">
      <header class="modal-card-head">
        <p class="modal-card-title">Search</p>
      </header>
      <section class="modal-card-body">
        <div class="field mb-2">
          <div class="control">
            <input class="input" id="search" placeholder="Search this website." type="search" />
          </div>
        </div>
        <div class="search-results">
          <div class="search-results__items"></div>
        </div>
      </section>
    </div>
    <button aria-label="close" class="modal-close is-large"></button>
  </section>
  


  

<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <nav class="level">
              
          <div class="level-item has-text-centered">
            <a class="button is-black is-outlined" href="https:&#x2F;&#x2F;henrycc24.github.io&#x2F;Labs&#x2F;lab10&#x2F;">
              <span class="icon mr-2">
                <i class="fas fa-arrow-circle-left"></i>
              </span>
              Lab 10
            </a>
          </div>
           
        </nav>
      </div>
    </div>
  </div>
</section>



  



  
  <footer class="footer py-4">
    <div class="content has-text-centered">
      <p>
        Built with
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-code"></i>
          </span>
          <span>code</span>
        </span>
        and
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-heart"></i>
          </span>
          <span>love</span>
        </span>
      </p>
      <p>
        Powered by
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-power-off"></i>
          </span>
          <span>zola</span>
        </span>
      </p>
    </div>
  </footer>
  

  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/galleria.min.js" integrity="sha384-QSfwGT8/EU536DKdtyP2D6SLlh8zBaZ0cVkwfrwhqzIU9VCfJT00CLVP5t+HAiYg" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/galleria@1.6.1/dist/themes/folio/galleria.folio.min.js" integrity="sha384-DwpKI+deZB267+hPKwiOIc5Y2GKsVL0mR6hgz7GgIu7AgAMYqJwcJKY1YBNfhWcY" crossorigin="anonymous"></script>
  
  
  <script src="https://cdn.jsdelivr.net/npm/mermaid@8.13.5/dist/mermaid.min.js" integrity="sha384-0yWn54pSGtfKCU+skfA69l25VsCw+MZt4LQov3xNRoS7YkAMrFokGgSBnAWSK4pv" crossorigin="anonymous"></script>
  
  
  <script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1.1.13/dist/chart.xkcd.min.js" integrity="sha384-xC3h1+IHXK8seA+8KfT79Z4e0GPsznjXBoMa5nd8ooWKplPyXx92NOmljWxLC/cs" crossorigin="anonymous"></script>
  
  
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js" integrity="sha384-Pulw7+h73841BQIK0LzJCydKRPChJUF9w8h8W0o3h+cLtoyNPJS847bQauLWOTwg" crossorigin="anonymous"></script>
  
  <script src="https://henrycc24.github.io/elasticlunr.min.js"></script>
  <script src="https://henrycc24.github.io/search_index.en.js"></script><script src="https://henrycc24.github.io/js/site.js"></script>

  





  
  
</body>

</html>
